---
format_version: '11'
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git

workflows:
  run_tests:
    description: USA Home iOS Build
    steps:
    - git-clone@8: {}
    - script@1:
        title: Install Dependencies and Setup iOS
        inputs:
        - content: |
            #!/usr/bin/env bash
            set -ex
            
            echo "Installing npm dependencies..."
            npm install
            
            echo "Checking Capacitor installation..."
            ls -la node_modules/@capacitor/ios/
            
            echo "Changing to iOS app directory..."
            cd ios/App
            
            echo "Installing CocoaPods dependencies..."
            pod install --verbose
            
            echo "Dependencies installed successfully"
    - xcode-test@4:
        inputs:
        - project_path: ios/App/App.xcworkspace
        - scheme: App
        - destination: platform=iOS Simulator,name=iPhone 15,OS=latest
    - deploy-to-bitrise-io@2:
        inputs:
        - notify_user_groups: none
        - is_enable_public_page: false
